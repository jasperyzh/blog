---
import { getCollection, CollectionEntry } from "astro:content";

import Layout from "../../layouts/Layout.astro";
import Card from "../../layouts/Card.astro";
import Pagination from "../../layouts/_Pagination.astro";

import { formatBlogPosts } from "../../layouts/_Utils";

export async function getStaticPaths({ paginate }) {
  const allPosts = await getCollection("blog");
  const formattedPosts: CollectionEntry<"blog">[] = formatBlogPosts(allPosts);

  return paginate(formattedPosts, {
    pageSize: 6,
  });
}

const { page } = Astro.props;
---

<Layout>
  <!-- sort by tag|date -->

  <section id="blog-posts">
    {
      page.data.map((post) => (
        <Card data={post.data} url={post.slug} heading="h2" image={post.slug} />
      ))
    }
    <Pagination prevUrl={page.url.prev} nextUrl={page.url.next} />
  </section>
</Layout>
<style>
  #blog-posts {
    display: grid;
    gap: var(--size);
  }
</style>
